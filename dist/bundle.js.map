{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@babel/runtime/helpers/getPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/defineProperty.js","webpack:///./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack:///./node_modules/@babel/runtime/helpers/createClass.js","webpack:///./node_modules/@babel/runtime/helpers/assertThisInitialized.js","webpack:///./node_modules/@babel/runtime/helpers/inherits.js","webpack:///./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","webpack:///./node_modules/@babel/runtime/helpers/slicedToArray.js","webpack:///./node_modules/@babel/runtime/helpers/get.js","webpack:///./node_modules/@babel/runtime/regenerator/index.js","webpack:///./node_modules/@babel/runtime/helpers/asyncToGenerator.js","webpack:///./src/shaders/v.glsl","webpack:///./src/shaders/f.glsl","webpack:///./node_modules/regenerator-runtime/runtime.js","webpack:///./node_modules/@babel/runtime/helpers/arrayWithHoles.js","webpack:///./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","webpack:///./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/arrayLikeToArray.js","webpack:///./node_modules/@babel/runtime/helpers/nonIterableRest.js","webpack:///./node_modules/@babel/runtime/helpers/setPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/typeof.js","webpack:///./node_modules/@babel/runtime/helpers/superPropBase.js","webpack:///./src/js/m4.js","webpack:///./src/js/utils.js","webpack:///./src/js/UserInput.js","webpack:///./src/js/RenderScene.js","webpack:///./src/js/Shapes/TexturedShape.js","webpack:///./src/js/Shapes/TriangleBasedShape.js","webpack:///./src/js/Shapes/Shape.js","webpack:///./src/js/Shapes/ObjFileShape.js","webpack:///./src/js/Texture/Texture.js","webpack:///./src/js/Texture/URLTexture.js","webpack:///./src/js/Shapes/CameraMappedTexturedShape.js","webpack:///./src/js/Texture/RenderTargetTexture.js","webpack:///./src/js/Shapes/Portal.js","webpack:///./src/js/MovementMangers/PortalWASDMovement.js","webpack:///./src/js/MovementMangers/AnimationManager.js","webpack:///./src/js/main.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","_getPrototypeOf","setPrototypeOf","getPrototypeOf","__proto__","obj","configurable","writable","instance","Constructor","TypeError","_defineProperties","target","props","length","descriptor","protoProps","staticProps","self","ReferenceError","subClass","superClass","constructor","_typeof","assertThisInitialized","arrayWithHoles","iterableToArrayLimit","unsupportedIterableToArray","nonIterableRest","arr","superPropBase","_get","receiver","Reflect","base","desc","getOwnPropertyDescriptor","asyncGeneratorStep","gen","resolve","reject","_next","_throw","arg","info","error","done","Promise","then","fn","this","args","arguments","apply","err","undefined","runtime","Op","hasOwn","$Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","wrap","innerFn","outerFn","tryLocsList","protoGenerator","Generator","generator","context","Context","_invoke","state","method","Error","doneResult","delegate","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","record","tryCatch","type","makeInvokeMethod","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","AsyncIterator","PromiseImpl","previousPromise","callInvokeWithMethodAndArg","invoke","result","__await","unwrapped","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","displayName","isGeneratorFunction","genFun","ctor","mark","awrap","async","iter","toString","keys","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","regeneratorRuntime","accidentalStrictMode","Function","Array","isArray","_arr","_n","_d","_e","_s","_i","arrayLikeToArray","minLen","from","test","len","arr2","_setPrototypeOf","multiply","a","b","dst","b00","b01","b02","b03","b10","b11","b12","b13","b20","b21","b22","b23","b30","b31","b32","b33","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","a30","a31","a32","a33","inverse","m00","m01","m02","m03","m10","m11","m12","m13","m20","m21","m22","m23","m30","m31","m32","m33","tmp_0","tmp_1","tmp_2","tmp_3","tmp_4","tmp_5","tmp_6","tmp_7","tmp_8","tmp_9","tmp_10","tmp_11","tmp_12","tmp_13","tmp_14","tmp_15","tmp_16","tmp_17","tmp_18","tmp_19","tmp_20","tmp_21","tmp_22","tmp_23","t0","t1","t2","t3","translate","tx","ty","tz","translationMatrix","xRotate","angleInRadius","angleInRadians","Math","cos","sin","yRotate","zRotate","scale3D","sx","sy","sz","scalingMatrix","EYE","transformVector","v","j","createShader","gl","source","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","console","log","getShaderInfoLog","deleteShader","UserInput","element","keymap","mouseX","mouseY","keydown","keyup","mousemove","readMouseMove","document","body","addEventListener","e","requestPointerLock","focus","preventDefault","movementX","movementY","RenderScene","secondaryScene","WeakMap","draw","drawLoop","drawObject","addObject","input","defaultProgram","canvas","multiplier","width","clientWidth","height","clientHeight","resizeCanvasToDisplaySize","viewport","vertexShader","VERTEX_SHADER","vertexShaderSource","fragmentShader","FRAGMENT_SHADER","fragmentShaderSource","enable","DEPTH_TEST","CULL_FACE","program","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","deleteProgram","useProgram","matrixLocation","getUniformLocation","textureLocation","textureFlagLocation","positionLocation","getAttribLocation","colorLocation","textureMapLocation","aspect","perspectiveMatrix","fieldOfViewInRadians","near","far","f","tan","PI","rangeInv","perspective","farCutoff","init","objects","time","animationManager","update","requestAnimationFrame","projectionMatrix","cameraMatrix","clearColor","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","buffers","vector","transformationMatrix","matrix","uniformMatrix4fv","uniform1i","bindBuffer","ARRAY_BUFFER","positionBuffer","enableVertexAttribArray","vertexAttribPointer","FLOAT","textureMapBuffer","colorBuffer","drawArrays","drawMode","vertices","mm","TexturedShape","texture","scene","lock","u","getUniform","typeFlag","bindTexture","TEXTURE_2D","colorAllFaces","rotateX","rotateY","rotateZ","scale","color","colors","concat","Float32Array","createBuffer","bufferData","STATIC_DRAW","textureMap","set","x","y","z","angle","ObjFileShape","objfile","resizeFactor","objFile","lines","split","texCoo","vertexArr","texMapArr","substr","map","parseFloat","tex","tex0","tex1","line","vertex","parseInt","flat","parseObjFile","Texture","URLTexture","url","createTexture","internalFormat","RGBA","srcFormat","srcType","UNSIGNED_BYTE","pixel","Uint8Array","texImage2D","image","Image","onload","ext","getExtension","max","getParameter","MAX_TEXTURE_MAX_ANISOTROPY_EXT","texParameterf","TEXTURE_MAX_ANISOTROPY_EXT","isPowerOf2","generateMipmap","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","LINEAR","src","loadTexture","CameraMappedTexturedShape","RenderTargetTexture","targetScene","bindFrameBuffer","unbindFrameBuffer","targetTextureWidth","targetTextureHeight","targetTexture","format","NEAREST","TEXTURE_MAG_FILTER","fb","createFramebuffer","bindFramebuffer","FRAMEBUFFER","depthBuffer","createRenderbuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","DEPTH_STENCIL","framebufferRenderbuffer","DEPTH_STENCIL_ATTACHMENT","attachmentPoint","COLOR_ATTACHMENT0","framebufferTexture2D","frameBuffer","stack","old","oldCamera","oldProjection","Portal","targetTransformationMatrix","textureScene","targetLocation","forceRender","id","floor","random","renderCallStack","buffer","sum","queryRecord","reduce","queries","query","createQuery","queryInProgress","getQueryRecord","occluded","getQueryParameter","QUERY_RESULT_AVAILABLE","QUERY_RESULT","getQueryStatus","STENCIL_BUFFER_BIT","STENCIL_TEST","stencilOp","KEEP","REPLACE","stencilFunc","ALWAYS","stencilMask","enableStencilWrite","portal","oldProjectionMatrix","paintStencil","EQUAL","useStencilMask","flag","disable","cleanUpStencil","beginQuery","ANY_SAMPLES_PASSED","endQuery","PortalWASDMovement","candidates","filter","newPoint","cameraX","cameraY","cameraZ","nearPortal","oldTime","timediff","readKeymap","zmove","xmove","w","movementSpeed","makeRadius","cameraYaw","cameraPitch","resultMove","tform","atan2","querySelector","getContext","stencil","s1","s2","registerAnimationManager","loadObj","island3","island2","inside","island1","room1","star1","room2","star2","addPortalPair","scene1","location1","scene2","location2","texScene1","texScene2","flipPortal","portal2","model","ut1","fetch","response","text","House","main"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 22);\n","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;","var _typeof = require(\"../helpers/typeof\");\n\nvar assertThisInitialized = require(\"./assertThisInitialized\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;","var arrayWithHoles = require(\"./arrayWithHoles\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableRest = require(\"./nonIterableRest\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;","var superPropBase = require(\"./superPropBase\");\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    module.exports = _get = Reflect.get;\n  } else {\n    module.exports = _get = function _get(target, property, receiver) {\n      var base = superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nmodule.exports = _get;","module.exports = require(\"regenerator-runtime\");\n","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nmodule.exports = _asyncToGenerator;","module.exports = \"attribute vec4 a_position;\\r\\nattribute vec4 a_color;\\r\\nattribute vec2 a_texcoord;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\nvarying vec4 v_color;\\r\\nvarying vec2 v_texcoord;\\r\\nvarying vec4 v_position;\\r\\n\\r\\nvoid main() {\\r\\n    gl_Position = u_matrix * a_position;\\r\\n\\r\\n    v_color = a_color;\\r\\n    v_texcoord=a_texcoord;\\r\\n    v_position=gl_Position;\\r\\n}\"","module.exports = \"// fragment shaders don't have a default precision so we need\\r\\n// to pick one. mediump is a good default\\r\\nprecision mediump float;\\r\\n\\r\\nuniform int u_useTexture;\\r\\nuniform sampler2D u_texture;\\r\\n\\r\\nvarying vec4 v_color;\\r\\nvarying vec4 v_position;\\r\\nvarying vec2 v_texcoord;\\r\\nvoid main() {\\r\\n    if (u_useTexture==0){\\r\\n        gl_FragColor = v_color;\\r\\n    }else if (u_useTexture==1){\\r\\n        gl_FragColor = texture2D(u_texture, v_texcoord);\\r\\n    }else{\\r\\n        gl_FragColor =0.0*vec4(.15,.0,.0,.0)+texture2D(u_texture, 0.5*(v_position.xy/v_position.w)+0.5);\\r\\n    }\\r\\n}\"","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;","function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(n);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","var getPrototypeOf = require(\"./getPrototypeOf\");\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nmodule.exports = _superPropBase;","//library from: https://twgljs.org/docs/module-twgl_m4.html\r\n\r\n//cross product calculation of 2 vectors\r\n//returns a vector orthogonal to both a and b\r\nfunction cross(a, b) {\r\n    return [a[1] * b[2] - a[2] * b[1],\r\n        a[2] * b[0] - a[0] * b[2],\r\n        a[0] * b[1] - a[1] * b[0]];\r\n}\r\n\r\n//basic vector subtraction of vectors a and b\r\n// a - b = returned vector\r\nfunction subtractVectors(a, b) {\r\n    return [a[0] - b[0], a[1] - b[1], a[2] - b[2]];\r\n}\r\n\r\n//vector normalization to get a unit vector from v\r\nfunction normalize(v) {\r\n    var length = Math.sqrt(v[0] * v[0] + v[1] * v[1] + v[2] * v[2]);\r\n    // make sure we don't divide by 0.\r\n    if (length > 0.00001) {\r\n        return [v[0] / length, v[1] / length, v[2] / length];\r\n    } else {\r\n        return [0, 0, 0];\r\n    }\r\n}\r\n\r\n//3 dimensional translation matrix\r\nconst translationMatrix = function (tx, ty, tz) {\r\n    return [\r\n        1, 0, 0, 0,\r\n        0, 1, 0, 0,\r\n        0, 0, 1, 0,\r\n        tx, ty, tz, 1,\r\n    ];\r\n};\r\n\r\n//3 dimensional rotation matrix, rotation about x\r\n//rotation is defined by counterclockwise as positive\r\nconst xRotationMatrix = function (angleInRadians) {\r\n    const c = Math.cos(angleInRadians);\r\n    const s = Math.sin(angleInRadians);\r\n\r\n    return [\r\n        1, 0, 0, 0,\r\n        0, c, s, 0,\r\n        0, -s, c, 0,\r\n        0, 0, 0, 1,\r\n    ];\r\n};\r\n\r\n//3 dimensional rotation matrix, rotation about y\r\n//rotation is defined by counterclockwise as positive\r\nconst yRotationMatrix = function (angleInRadians) {\r\n    const c = Math.cos(angleInRadians);\r\n    const s = Math.sin(angleInRadians);\r\n\r\n    return [\r\n        c, 0, -s, 0,\r\n        0, 1, 0, 0,\r\n        s, 0, c, 0,\r\n        0, 0, 0, 1,\r\n    ];\r\n};\r\n\r\n//3 dimensional rotation matrix, rotation about z\r\n//rotation is defined by counterclockwise as positive\r\nconst zRotationMatrix = function (angleInRadians) {\r\n    const c = Math.cos(angleInRadians);\r\n    const s = Math.sin(angleInRadians);\r\n\r\n    return [\r\n        c, s, 0, 0,\r\n        -s, c, 0, 0,\r\n        0, 0, 1, 0,\r\n        0, 0, 0, 1,\r\n    ];\r\n};\r\n\r\n//3 dimensional scaling matrix\r\n//input the scaling factors for x y and z respectively\r\nconst scalingMatrix = function (sx, sy, sz) {\r\n    return [\r\n        sx, 0, 0, 0,\r\n        0, sy, 0, 0,\r\n        0, 0, sz, 0,\r\n        0, 0, 0, 1,\r\n    ];\r\n};\r\n\r\n//matrix multiplication function\r\n//currently it is very hardcoded in terms of implementation\r\n//TODO: modularize\r\nexport function multiply(a, b) {\r\n    const dst = [];\r\n    const b00 = b[0 * 4 + 0];\r\n    const b01 = b[0 * 4 + 1];\r\n    const b02 = b[0 * 4 + 2];\r\n    const b03 = b[0 * 4 + 3];\r\n    const b10 = b[1 * 4 + 0];\r\n    const b11 = b[1 * 4 + 1];\r\n    const b12 = b[1 * 4 + 2];\r\n    const b13 = b[1 * 4 + 3];\r\n    const b20 = b[2 * 4 + 0];\r\n    const b21 = b[2 * 4 + 1];\r\n    const b22 = b[2 * 4 + 2];\r\n    const b23 = b[2 * 4 + 3];\r\n    const b30 = b[3 * 4 + 0];\r\n    const b31 = b[3 * 4 + 1];\r\n    const b32 = b[3 * 4 + 2];\r\n    const b33 = b[3 * 4 + 3];\r\n    const a00 = a[0 * 4 + 0];\r\n    const a01 = a[0 * 4 + 1];\r\n    const a02 = a[0 * 4 + 2];\r\n    const a03 = a[0 * 4 + 3];\r\n    const a10 = a[1 * 4 + 0];\r\n    const a11 = a[1 * 4 + 1];\r\n    const a12 = a[1 * 4 + 2];\r\n    const a13 = a[1 * 4 + 3];\r\n    const a20 = a[2 * 4 + 0];\r\n    const a21 = a[2 * 4 + 1];\r\n    const a22 = a[2 * 4 + 2];\r\n    const a23 = a[2 * 4 + 3];\r\n    const a30 = a[3 * 4 + 0];\r\n    const a31 = a[3 * 4 + 1];\r\n    const a32 = a[3 * 4 + 2];\r\n    const a33 = a[3 * 4 + 3];\r\n    dst[0] = b00 * a00 + b01 * a10 + b02 * a20 + b03 * a30;\r\n    dst[1] = b00 * a01 + b01 * a11 + b02 * a21 + b03 * a31;\r\n    dst[2] = b00 * a02 + b01 * a12 + b02 * a22 + b03 * a32;\r\n    dst[3] = b00 * a03 + b01 * a13 + b02 * a23 + b03 * a33;\r\n    dst[4] = b10 * a00 + b11 * a10 + b12 * a20 + b13 * a30;\r\n    dst[5] = b10 * a01 + b11 * a11 + b12 * a21 + b13 * a31;\r\n    dst[6] = b10 * a02 + b11 * a12 + b12 * a22 + b13 * a32;\r\n    dst[7] = b10 * a03 + b11 * a13 + b12 * a23 + b13 * a33;\r\n    dst[8] = b20 * a00 + b21 * a10 + b22 * a20 + b23 * a30;\r\n    dst[9] = b20 * a01 + b21 * a11 + b22 * a21 + b23 * a31;\r\n    dst[10] = b20 * a02 + b21 * a12 + b22 * a22 + b23 * a32;\r\n    dst[11] = b20 * a03 + b21 * a13 + b22 * a23 + b23 * a33;\r\n    dst[12] = b30 * a00 + b31 * a10 + b32 * a20 + b33 * a30;\r\n    dst[13] = b30 * a01 + b31 * a11 + b32 * a21 + b33 * a31;\r\n    dst[14] = b30 * a02 + b31 * a12 + b32 * a22 + b33 * a32;\r\n    dst[15] = b30 * a03 + b31 * a13 + b32 * a23 + b33 * a33;\r\n    return dst;\r\n}\r\n\r\n//matrix inverse calculation\r\nexport function inverse(m) {\r\n    var m00 = m[0 * 4 + 0];\r\n    var m01 = m[0 * 4 + 1];\r\n    var m02 = m[0 * 4 + 2];\r\n    var m03 = m[0 * 4 + 3];\r\n    var m10 = m[1 * 4 + 0];\r\n    var m11 = m[1 * 4 + 1];\r\n    var m12 = m[1 * 4 + 2];\r\n    var m13 = m[1 * 4 + 3];\r\n    var m20 = m[2 * 4 + 0];\r\n    var m21 = m[2 * 4 + 1];\r\n    var m22 = m[2 * 4 + 2];\r\n    var m23 = m[2 * 4 + 3];\r\n    var m30 = m[3 * 4 + 0];\r\n    var m31 = m[3 * 4 + 1];\r\n    var m32 = m[3 * 4 + 2];\r\n    var m33 = m[3 * 4 + 3];\r\n    var tmp_0 = m22 * m33;\r\n    var tmp_1 = m32 * m23;\r\n    var tmp_2 = m12 * m33;\r\n    var tmp_3 = m32 * m13;\r\n    var tmp_4 = m12 * m23;\r\n    var tmp_5 = m22 * m13;\r\n    var tmp_6 = m02 * m33;\r\n    var tmp_7 = m32 * m03;\r\n    var tmp_8 = m02 * m23;\r\n    var tmp_9 = m22 * m03;\r\n    var tmp_10 = m02 * m13;\r\n    var tmp_11 = m12 * m03;\r\n    var tmp_12 = m20 * m31;\r\n    var tmp_13 = m30 * m21;\r\n    var tmp_14 = m10 * m31;\r\n    var tmp_15 = m30 * m11;\r\n    var tmp_16 = m10 * m21;\r\n    var tmp_17 = m20 * m11;\r\n    var tmp_18 = m00 * m31;\r\n    var tmp_19 = m30 * m01;\r\n    var tmp_20 = m00 * m21;\r\n    var tmp_21 = m20 * m01;\r\n    var tmp_22 = m00 * m11;\r\n    var tmp_23 = m10 * m01;\r\n\r\n    var t0 = (tmp_0 * m11 + tmp_3 * m21 + tmp_4 * m31) -\r\n        (tmp_1 * m11 + tmp_2 * m21 + tmp_5 * m31);\r\n    var t1 = (tmp_1 * m01 + tmp_6 * m21 + tmp_9 * m31) -\r\n        (tmp_0 * m01 + tmp_7 * m21 + tmp_8 * m31);\r\n    var t2 = (tmp_2 * m01 + tmp_7 * m11 + tmp_10 * m31) -\r\n        (tmp_3 * m01 + tmp_6 * m11 + tmp_11 * m31);\r\n    var t3 = (tmp_5 * m01 + tmp_8 * m11 + tmp_11 * m21) -\r\n        (tmp_4 * m01 + tmp_9 * m11 + tmp_10 * m21);\r\n\r\n    var d = 1.0 / (m00 * t0 + m10 * t1 + m20 * t2 + m30 * t3);\r\n\r\n    return [\r\n        d * t0,\r\n        d * t1,\r\n        d * t2,\r\n        d * t3,\r\n        d * ((tmp_1 * m10 + tmp_2 * m20 + tmp_5 * m30) -\r\n            (tmp_0 * m10 + tmp_3 * m20 + tmp_4 * m30)),\r\n        d * ((tmp_0 * m00 + tmp_7 * m20 + tmp_8 * m30) -\r\n            (tmp_1 * m00 + tmp_6 * m20 + tmp_9 * m30)),\r\n        d * ((tmp_3 * m00 + tmp_6 * m10 + tmp_11 * m30) -\r\n            (tmp_2 * m00 + tmp_7 * m10 + tmp_10 * m30)),\r\n        d * ((tmp_4 * m00 + tmp_9 * m10 + tmp_10 * m20) -\r\n            (tmp_5 * m00 + tmp_8 * m10 + tmp_11 * m20)),\r\n        d * ((tmp_12 * m13 + tmp_15 * m23 + tmp_16 * m33) -\r\n            (tmp_13 * m13 + tmp_14 * m23 + tmp_17 * m33)),\r\n        d * ((tmp_13 * m03 + tmp_18 * m23 + tmp_21 * m33) -\r\n            (tmp_12 * m03 + tmp_19 * m23 + tmp_20 * m33)),\r\n        d * ((tmp_14 * m03 + tmp_19 * m13 + tmp_22 * m33) -\r\n            (tmp_15 * m03 + tmp_18 * m13 + tmp_23 * m33)),\r\n        d * ((tmp_17 * m03 + tmp_20 * m13 + tmp_23 * m23) -\r\n            (tmp_16 * m03 + tmp_21 * m13 + tmp_22 * m23)),\r\n        d * ((tmp_14 * m22 + tmp_17 * m32 + tmp_13 * m12) -\r\n            (tmp_16 * m32 + tmp_12 * m12 + tmp_15 * m22)),\r\n        d * ((tmp_20 * m32 + tmp_12 * m02 + tmp_19 * m22) -\r\n            (tmp_18 * m22 + tmp_21 * m32 + tmp_13 * m02)),\r\n        d * ((tmp_18 * m12 + tmp_23 * m32 + tmp_15 * m02) -\r\n            (tmp_22 * m32 + tmp_14 * m02 + tmp_19 * m12)),\r\n        d * ((tmp_22 * m22 + tmp_16 * m02 + tmp_21 * m12) -\r\n            (tmp_20 * m12 + tmp_23 * m22 + tmp_17 * m02))\r\n    ];\r\n}\r\n\r\n//everything here and below is basically using export statement in \r\n//Javascript in order to create the bindings to the functions defined\r\n\r\nexport const translate = function (m, tx, ty, tz) {\r\n    return multiply(m, translationMatrix(tx, ty, tz));\r\n};\r\n\r\nexport const xRotate = function (m, angleInRadius) {\r\n    return multiply(m, xRotationMatrix(angleInRadius));\r\n};\r\n\r\nexport const yRotate = function (m, angleInRadius) {\r\n    return multiply(m, yRotationMatrix(angleInRadius));\r\n};\r\n\r\nexport const zRotate = function (m, angleInRadius) {\r\n    return multiply(m, zRotationMatrix(angleInRadius));\r\n};\r\n\r\nexport const scale3D = function (m, sx, sy, sz) {\r\n    return multiply(m, scalingMatrix(sx, sy, sz));\r\n};\r\n\r\n//projection matrix from lecture\r\nexport const projection = function\r\n    (width, height, depth) {\r\n    // Note: This matrix flips the Y axis so 0 is at the top.\r\n    return [\r\n        2 / width, 0, 0, 0,\r\n        0, -2 / height, 0, 0,\r\n        0, 0, 2 / depth, 0,\r\n        -1, 1, 0, 1,\r\n    ];\r\n}\r\n\r\n//perspective matrix from lecture\r\nexport const perspective = function (fieldOfViewInRadians, aspect, near, far) {\r\n    var f = Math.tan(Math.PI * 0.5 - 0.5 * fieldOfViewInRadians);\r\n    var rangeInv = 1.0 / (near - far);\r\n\r\n    return [\r\n        f / aspect, 0, 0, 0,\r\n        0, f, 0, 0,\r\n        0, 0, (near + far) * rangeInv, -1,\r\n        0, 0, near * far * rangeInv * 2, 0\r\n    ];\r\n}\r\n\r\n//EYE matrix\r\nexport const EYE = [\r\n    1, 0, 0, 0,\r\n    0, 1, 0, 0,\r\n    0, 0, 1, 0,\r\n    0, 0, 0, 1];\r\n\r\n/**\r\n * generate camera space to word space transformation\r\n * @param position the 3d position of camera\r\n * @param target the object in center of view\r\n * @param up up\r\n * @returns {(*|number)[]}\r\n */\r\nexport const lookAt = function (position, target, up) {\r\n    var zAxis = normalize(\r\n        subtractVectors(position, target));\r\n    var xAxis = normalize(cross(up, zAxis));\r\n    var yAxis = normalize(cross(zAxis, xAxis));\r\n\r\n    return [\r\n        xAxis[0], xAxis[1], xAxis[2], 0,\r\n        yAxis[0], yAxis[1], yAxis[2], 0,\r\n        zAxis[0], zAxis[1], zAxis[2], 0,\r\n        position[0],\r\n        position[1],\r\n        position[2],\r\n        1,\r\n    ];\r\n}\r\n\r\nexport   function transformVector(m, v, dst) {\r\n    dst = dst || [0,0,0,0];\r\n    for (var i = 0; i < 4; ++i) {\r\n        dst[i] = 0.0;\r\n        for (var j = 0; j < 4; ++j) {\r\n            dst[i] += v[j] * m[j * 4 + i];\r\n        }\r\n    }\r\n    return dst;\r\n}\r\n","\r\n// source: https://developer.mozilla.org/en-US/docs/Web/API/WebGLShader\r\nexport function createShader(gl, type, source) {\r\n    var shader = gl.createShader(type);\r\n    gl.shaderSource(shader, source);\r\n    gl.compileShader(shader);\r\n    var success = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\r\n    if (success) {\r\n        return shader;\r\n    }\r\n\r\n    console.log(gl.getShaderInfoLog(shader));\r\n    gl.deleteShader(shader);\r\n}\r\n\r\n// source: https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/createProgram\r\nexport function createProgram(gl, vertexShader, fragmentShader) {\r\n    var program = gl.createProgram();\r\n    gl.attachShader(program, vertexShader);\r\n    gl.attachShader(program, fragmentShader);\r\n    gl.linkProgram(program);\r\n    var success = gl.getProgramParameter(program, gl.LINK_STATUS);\r\n    if (success) {\r\n        return program;\r\n    }\r\n    gl.deleteProgram(program);\r\n}\r\n\r\n// source: https://webglfundamentals.org/webgl/lessons/webgl-resizing-the-canvas.html\r\nexport function resizeCanvasToDisplaySize(canvas, multiplier) {\r\n    multiplier = multiplier || 1;\r\n    const width = canvas.clientWidth * multiplier | 0;\r\n    const height = canvas.clientHeight * multiplier | 0;\r\n    if (canvas.width !== width || canvas.height !== height) {\r\n        canvas.width = width;\r\n        canvas.height = height;\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n\r\n","//this implementation is required for our project to move the perscpective of the\r\n//user based on their movements and inputs from their input devices, such as \r\n//the keyboard and mouse\r\n\r\nexport class UserInput {\r\n    /**\r\n     *\r\n     * @param element{HTMLElement}\r\n     */\r\n    constructor(element) {\r\n        this.keymap = {};\r\n        this.mouseX = 0;\r\n        this.mouseY = 0;\r\n        this.keydown = this.keydown.bind(this);\r\n        this.keyup = this.keyup.bind(this);\r\n        this.mousemove = this.mousemove.bind(this);\r\n        this.readMouseMove = this.readMouseMove.bind(this);\r\n        document.body.addEventListener(\"keyup\", this.keyup, false);\r\n        document.body.addEventListener(\"keydown\", this.keydown, false);\r\n        element.addEventListener(\"mousemove\", this.mousemove, false);\r\n        element.addEventListener(\"click\", (e) => {\r\n            element.requestPointerLock();\r\n            element.focus();\r\n            e.preventDefault();\r\n        }, false);\r\n    }\r\n\r\n    keydown(e) {\r\n        this.keymap[e.key] = true;\r\n    }\r\n\r\n    keyup(e) {\r\n        this.keymap[e.key] = false;\r\n    }\r\n\r\n    mousemove(e) {\r\n        this.mouseX += e.movementX;\r\n        this.mouseY += e.movementY;\r\n    }\r\n\r\n    /**\r\n     * return keymap.\r\n     * @returns {{}}\r\n     */\r\n    readKeymap(){\r\n        return this.keymap;\r\n    }\r\n\r\n    /**\r\n     * return mouse relative movement.\r\n     * @returns {[number, number]}\r\n     */\r\n    readMouseMove() {\r\n        const result = [this.mouseX, this.mouseY];\r\n        this.mouseX = 0;\r\n        this.mouseY = 0;\r\n        return result;\r\n    }\r\n}\r\n","import {createProgram, createShader, resizeCanvasToDisplaySize} from \"./utils\";\r\nimport vertexShaderSource from \"shaders/v.glsl\";\r\nimport fragmentShaderSource from \"shaders/f.glsl\";\r\nimport {multiply, perspective, transformVector} from \"./m4\";\r\nimport {UserInput} from \"./UserInput\";\r\n\r\nexport class RenderScene {\r\n    objects = [];\r\n    farCutoff = 30;\r\n    /**\r\n     *\r\n     * @type {AnimationManager}\r\n     */\r\n    animationManager = null;\r\n    /**\r\n     *\r\n     * @type {WeakMap<(Shape|Texture), any>}\r\n     */\r\n    buffers = new WeakMap();\r\n    cameraMatrix;\r\n\r\n    /**\r\n     *\r\n     * @param gl {WebGL2RenderingContext}\r\n     */\r\n    constructor(gl, secondaryScene) {\r\n        this.draw = this.draw.bind(this);\r\n        this.drawLoop = this.drawLoop.bind(this);\r\n        this.drawObject = this.drawObject.bind(this);\r\n        this.addObject = this.addObject.bind(this);\r\n        this.gl = gl;\r\n        if (!secondaryScene) {\r\n            this.input = new UserInput(gl.canvas);\r\n            resizeCanvasToDisplaySize(gl.canvas, 2);\r\n            gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\r\n            const vertexShader = createShader(gl, gl.VERTEX_SHADER, vertexShaderSource);\r\n            const fragmentShader = createShader(gl, gl.FRAGMENT_SHADER, fragmentShaderSource);\r\n            gl.enable(gl.DEPTH_TEST);\r\n            gl.enable(gl.CULL_FACE);\r\n            this.defaultProgram = createProgram(gl, vertexShader, fragmentShader);\r\n            gl.useProgram(this.defaultProgram);\r\n        } else {\r\n            this.input = secondaryScene.input;\r\n            this.defaultProgram = secondaryScene.defaultProgram;\r\n        }\r\n\r\n        this.matrixLocation = gl.getUniformLocation(this.defaultProgram, 'u_matrix');\r\n        this.textureLocation = gl.getUniformLocation(this.defaultProgram, 'u_texture');\r\n        this.textureFlagLocation = gl.getUniformLocation(this.defaultProgram, 'u_useTexture');\r\n        this.positionLocation = gl.getAttribLocation(this.defaultProgram, 'a_position');\r\n        this.colorLocation = gl.getAttribLocation(this.defaultProgram, 'a_color');\r\n        this.textureMapLocation = gl.getAttribLocation(this.defaultProgram, 'a_texcoord');\r\n        const aspect = this.gl.canvas.clientWidth / this.gl.canvas.clientHeight;\r\n        this.perspectiveMatrix = perspective(Math.PI / 4, aspect, 0.0005, this.farCutoff);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param obj{Shape}\r\n     */\r\n    addObject(obj) {\r\n        obj.init(this);\r\n        this.objects.push(obj);\r\n    }\r\n\r\n    drawLoop(time) {\r\n        if (this.animationManager) {\r\n            const shouldStop = this.animationManager.update(this, time);\r\n            if (shouldStop) return;\r\n        }\r\n\r\n\r\n        this.draw()\r\n        requestAnimationFrame(this.drawLoop);\r\n    }\r\n\r\n    draw() {\r\n        this.projectionMatrix = multiply(this.perspectiveMatrix, this.cameraMatrix);\r\n        const gl = this.gl;\r\n        gl.clearColor(0, 0, 0, 0);\r\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\r\n        for (let i = 0; i < this.objects.length; i++) {\r\n            const c = this.objects[i];\r\n            c.draw(this);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * draw one simple object in the scene\r\n     * @param c {Shape}\r\n     */\r\n    drawObject(c) {\r\n        const gl = this.gl;\r\n        //const program = this.defaultProgram;\r\n        const buffers = this.buffers.get(c);\r\n        if(this.cameraMatrix){\r\n            const vector = transformVector(this.cameraMatrix,[c.transformationMatrix[12],c.transformationMatrix[13],c.transformationMatrix[14],1]);\r\n            //console.log(vector);\r\n            if(vector[0]*vector[0]+vector[1]*vector[1]+vector[3]*vector[3]>this.farCutoff**2){\r\n                return;\r\n            }\r\n        }\r\n        const matrix = multiply(this.projectionMatrix, c.transformationMatrix);\r\n        //const textureFlag = c.textureMap && c.textureMap.length > 0;\r\n\r\n        gl.uniformMatrix4fv(this.matrixLocation, false, matrix);\r\n        //gl.uniform1i(this.textureFlagLocation, textureFlag);\r\n        gl.uniform1i(this.textureLocation, 0);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, buffers.positionBuffer);\r\n        gl.enableVertexAttribArray(this.positionLocation);\r\n        gl.vertexAttribPointer(this.positionLocation, 3, gl.FLOAT, false, 0, 0);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, buffers.textureMapBuffer);\r\n        gl.enableVertexAttribArray(this.textureMapLocation);\r\n        gl.vertexAttribPointer(this.textureMapLocation, 2, gl.FLOAT, false, 0, 0);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, buffers.colorBuffer);\r\n        gl.enableVertexAttribArray(this.colorLocation);\r\n        gl.vertexAttribPointer(this.colorLocation, 3, gl.FLOAT, false, 0, 0);\r\n        gl.drawArrays(gl[c.drawMode], 0, c.vertices.length);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param mm{AnimationManager}\r\n     */\r\n    registerAnimationManager(mm) {\r\n        this.animationManager = mm;\r\n        mm.init(this);\r\n    }\r\n}","import {TriangleBasedShape} from \"./TriangleBasedShape\";\r\n\r\nexport class TexturedShape extends TriangleBasedShape {\r\n    textureMap = [];\r\n    typeFlag=1;\r\n    /**\r\n     *\r\n     * @param texture{Texture}\r\n     */\r\n    constructor(texture) {\r\n        super();\r\n        this.texture = texture;\r\n    }\r\n\r\n    /**\r\n     * draw the object.\r\n     * Note that we disallow recursive self draw.\r\n     * @param scene\r\n     */\r\n    draw(scene) {\r\n        if (this.lock) {\r\n           return;\r\n        }\r\n        this.lock=true;\r\n        const u =(scene.gl.getUniform(scene.defaultProgram, scene.textureFlagLocation));\r\n        scene.gl.uniform1i(scene.textureFlagLocation, this.typeFlag);\r\n        this.texture.enable(scene);\r\n        scene.drawObject(this);\r\n        scene.gl.uniform1i(scene.textureFlagLocation, u);\r\n        this.lock=false;\r\n        scene.gl.bindTexture(scene.gl.TEXTURE_2D, null);\r\n    }\r\n\r\n    init(scene) {\r\n        super.init(scene);\r\n        this.texture.init(scene);\r\n    }\r\n}","import {Shape} from \"./Shape\";\r\n\r\nexport class TriangleBasedShape extends Shape {\r\n    drawMode=\"TRIANGLES\";\r\n    constructor() {\r\n        super();\r\n    }\r\n    draw(scene) {\r\n        const u =(scene.gl.getUniform(scene.defaultProgram, scene.textureFlagLocation));\r\n        scene.gl.uniform1i(scene.textureFlagLocation, this.typeFlag);\r\n        scene.drawObject(this);\r\n        scene.gl.uniform1i(scene.textureFlagLocation, u);\r\n    }\r\n}","import {EYE, multiply, scale3D, translate, xRotate, yRotate, zRotate} from \"../m4\";\r\n\r\nexport class Shape {\r\n    vertices = [];\r\n    colors = [];\r\n    textureMap = [];\r\n    transformationMatrix = EYE;\r\n    drawMode = \"unknown\";\r\n    typeFlag = 0;\r\n\r\n    constructor() {\r\n        this.colorAllFaces = this.colorAllFaces.bind(this);\r\n        this.draw = this.draw.bind(this);\r\n        this.init = this.init.bind(this);\r\n        this.translate = this.translate.bind(this);\r\n        this.rotateX = this.rotateX.bind(this);\r\n        this.rotateY = this.rotateY.bind(this);\r\n        this.rotateZ = this.rotateZ.bind(this);\r\n        this.scale=this.scale.bind(this);\r\n    }\r\n\r\n    /**\r\n     *  give each vertex a color.\r\n     * @param color\r\n     */\r\n    colorAllFaces(color) {\r\n        this.colors = [];\r\n        for (let i = 0; i < this.vertices.length; i++) {\r\n            this.colors = this.colors.concat(color);\r\n        }\r\n        this.colors = new Float32Array(this.colors);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param scene{RenderScene}\r\n     */\r\n    draw(scene) {\r\n        scene.drawObject(this);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param scene {RenderScene}\r\n     */\r\n    init(scene) {\r\n        const gl = scene.gl;\r\n        const result = {};\r\n        result.positionBuffer = gl.createBuffer();\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, result.positionBuffer);\r\n        gl.bufferData(gl.ARRAY_BUFFER, this.vertices, gl.STATIC_DRAW);\r\n        result.colorBuffer = gl.createBuffer();\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, result.colorBuffer);\r\n        gl.bufferData(gl.ARRAY_BUFFER, this.colors, gl.STATIC_DRAW);\r\n        result.textureMapBuffer = gl.createBuffer();\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, result.textureMapBuffer);\r\n        gl.bufferData(gl.ARRAY_BUFFER, this.textureMap, gl.STATIC_DRAW);\r\n        scene.buffers.set(this, result);\r\n    }\r\n\r\n    translate(x, y, z) {\r\n        this.transformationMatrix = multiply(translate(EYE, x, y, z), this.transformationMatrix);\r\n    }\r\n\r\n    rotateX(angle) {\r\n        this.transformationMatrix = multiply(xRotate(EYE, angle), this.transformationMatrix);\r\n    }\r\n\r\n    rotateY(angle) {\r\n        this.transformationMatrix = multiply(yRotate(EYE, angle), this.transformationMatrix);\r\n    }\r\n\r\n    rotateZ(angle) {\r\n        this.transformationMatrix = multiply(zRotate(EYE, angle), this.transformationMatrix);\r\n    }\r\n\r\n    scale(x, y, z) {\r\n        this.transformationMatrix = multiply(scale3D(EYE, x, y, z), this.transformationMatrix);\r\n    }\r\n\r\n}","import {TexturedShape} from \"./TexturedShape\";\r\n\r\nexport class ObjFileShape extends TexturedShape {\r\n    constructor(objfile, texture,resizeFactor) {\r\n        super(texture);\r\n        resizeFactor=resizeFactor||0.001;\r\n        [this.vertices, this.textureMap] = parseObjFile(objfile,resizeFactor);\r\n        this.vertices = new Float32Array(this.vertices);\r\n        this.textureMap = new Float32Array(this.textureMap);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * parse obj file content\r\n * @param objFile {String}\r\n * @param resizeFactor {number}\r\n */\r\nfunction parseObjFile(objFile,resizeFactor) {\r\n    const lines = objFile.split(\"\\n\");\r\n    let i = 0;\r\n    const vertices = [];\r\n    const texCoo = [];\r\n    let vertexArr = [];\r\n    let texMapArr = [];\r\n    while (lines[i].substr(0, 2) !== \"v \") i++;\r\n    while (lines[i].substr(0, 2) === \"v \") {\r\n        vertices.push(lines[i].substr(2).split(\" \").map((s) => parseFloat(s) * resizeFactor));\r\n        i++;\r\n    }\r\n    while (lines[i].substr(0, 3) !== \"vt \") i++;\r\n    while (lines[i].substr(0, 3) === \"vt \") {\r\n        const tex=lines[i].substr(3).split(\" \").map((s) => parseFloat(s)).slice(0, 2);\r\n        const tex0=tex[0];\r\n        const tex1=1-tex[1];\r\n        texCoo.push([tex0,tex1]);\r\n        i++;\r\n    }\r\n    while (lines[i].substr(0, 2) !== \"f \") i++;\r\n    while (lines[i].substr(0, 2) === \"f \") {\r\n        const line = lines[i].substr(2).split(\" \").map(d => d.split(\"/\"));\r\n        const vertex = [line[0][0], line[1][0], line[2][0]].map(d => vertices[parseInt(d) - 1]).flat();\r\n        const texture = [line[0][1], line[1][1], line[2][1]].map(d => texCoo[parseInt(d) - 1]).flat();\r\n        vertex.map(d => vertexArr.push(d))\r\n        texture.map(d => texMapArr.push(d))\r\n        i++;\r\n    }\r\n    return [vertexArr, texMapArr];\r\n}","export class Texture{\r\n    constructor() {\r\n        this.enable=this.enable.bind(this);\r\n        this.init =this.init.bind(this);\r\n    }\r\n\r\n    /**\r\n     * buffer the texture in scene.\r\n     * @param scene {RenderScene}\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    init(scene){\r\n    }\r\n\r\n    /**\r\n     * enable texture in scene.\r\n     * @param scene {RenderScene}\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    enable(scene) {\r\n    }\r\n\r\n}","import {Texture} from \"./Texture\";\r\n\r\nexport class URLTexture extends Texture{\r\n    constructor(url) {\r\n        super();\r\n        this.url=url;\r\n    }\r\n\r\n    /**\r\n     * buffer the texture in scene.\r\n     * @param scene {RenderScene}\r\n     */\r\n    init(scene){\r\n        const texture = loadTexture(scene.gl,this.url);\r\n        scene.buffers.set(this,texture);\r\n    }\r\n\r\n    /**\r\n     * enable texture in scene.\r\n     * @param scene {RenderScene}\r\n     */\r\n    enable(scene) {\r\n        scene.gl.bindTexture(scene.gl.TEXTURE_2D, scene.buffers.get(this));\r\n    }\r\n}\r\n\r\nfunction loadTexture(gl, url) {\r\n    const texture = gl.createTexture();\r\n    gl.bindTexture(gl.TEXTURE_2D, texture);\r\n\r\n    // Because images have to be download over the internet\r\n    // they might take a moment until they are ready.\r\n    // Until then put a single pixel in the texture so we can\r\n    // use it immediately. When the image has finished downloading\r\n    // we'll update the texture with the contents of the image.\r\n    const level = 0;\r\n    const internalFormat = gl.RGBA;\r\n    const width = 1;\r\n    const height = 1;\r\n    const border = 0;\r\n    const srcFormat = gl.RGBA;\r\n    const srcType = gl.UNSIGNED_BYTE;\r\n    const pixel = new Uint8Array([255, 255, 255, 255]);  // pure white\r\n    gl.texImage2D(gl.TEXTURE_2D, level, internalFormat,\r\n        width, height, border, srcFormat, srcType,\r\n        pixel);\r\n\r\n    const image = new Image();\r\n    image.onload = function() {\r\n        gl.bindTexture(gl.TEXTURE_2D, texture);\r\n        const ext = (\r\n            gl.getExtension('EXT_texture_filter_anisotropic') ||\r\n            gl.getExtension('MOZ_EXT_texture_filter_anisotropic') ||\r\n            gl.getExtension('WEBKIT_EXT_texture_filter_anisotropic')\r\n        );\r\n        if (ext){\r\n            const max = gl.getParameter(ext.MAX_TEXTURE_MAX_ANISOTROPY_EXT);\r\n            gl.texParameterf(gl.TEXTURE_2D, ext.TEXTURE_MAX_ANISOTROPY_EXT, max);\r\n        }\r\n        gl.texImage2D(gl.TEXTURE_2D, level, internalFormat,\r\n            srcFormat, srcType, image);\r\n\r\n        // WebGL1 has different requirements for power of 2 images\r\n        // vs non power of 2 images so check if the image is a\r\n        // power of 2 in both dimensions.\r\n        if (isPowerOf2(image.width) && isPowerOf2(image.height)) {\r\n            // Yes, it's a power of 2. Generate mips.\r\n            gl.generateMipmap(gl.TEXTURE_2D);\r\n        } else {\r\n            // No, it's not a power of 2. Turn off mips and set\r\n            // wrapping to clamp to edge\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n        }\r\n    };\r\n    image.src = url;\r\n    return texture;\r\n}\r\n\r\nfunction isPowerOf2(value) {\r\n    return (value & (value - 1)) == 0;\r\n}","import {TexturedShape} from \"./TexturedShape\";\r\n\r\nexport class CameraMappedTexturedShape extends TexturedShape{\r\n    typeFlag=2;\r\n}\r\n","import {Texture} from \"./Texture\";\r\nimport {multiply} from \"../m4\";\r\n\r\nexport class RenderTargetTexture extends Texture {\r\n    /**\r\n     *\r\n     * @param targetScene{RenderScene}\r\n     */\r\n    constructor(targetScene) {\r\n        super();\r\n        this.targetScene = targetScene;\r\n        this.cameraMatrix = undefined;\r\n        this.update = this.update.bind(this);\r\n        this.bindFrameBuffer = this.bindFrameBuffer.bind(this);\r\n        this.unbindFrameBuffer=this.unbindFrameBuffer.bind(this);\r\n    }\r\n\r\n    /**\r\n     * buffer the texture in scene.\r\n     * @param scene {RenderScene}\r\n     */\r\n    init(scene) {\r\n        this.cameraMatrix = scene.cameraMatrix;\r\n        // create to render to\r\n        const gl = scene.gl;\r\n        const targetTextureWidth = gl.canvas.width;\r\n        const targetTextureHeight = gl.canvas.height;\r\n        const targetTexture = gl.createTexture();\r\n        gl.bindTexture(gl.TEXTURE_2D, targetTexture);\r\n\r\n        // define size and format of level 0\r\n        const level = 0;\r\n        const internalFormat = gl.RGBA;\r\n        const border = 0;\r\n        const format = gl.RGBA;\r\n        const type = gl.UNSIGNED_BYTE;\r\n        const data = null;\r\n        gl.texImage2D(gl.TEXTURE_2D, level, internalFormat,\r\n            targetTextureWidth, targetTextureHeight, border,\r\n            format, type, data);\r\n\r\n        // set the filtering so we don't need mips\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n\r\n        // Create and bind the framebuffer\r\n        const fb = gl.createFramebuffer();\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, fb);\r\n\r\n        // create a depth renderbuffer\r\n        const depthBuffer = gl.createRenderbuffer();\r\n        gl.bindRenderbuffer(gl.RENDERBUFFER, depthBuffer);\r\n\r\n        // make a depth buffer and the same size as the targetTexture\r\n        gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_STENCIL, targetTextureWidth, targetTextureHeight);\r\n        gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_STENCIL_ATTACHMENT, gl.RENDERBUFFER, depthBuffer);\r\n\r\n        // attach the texture as the first color attachment\r\n        const attachmentPoint = gl.COLOR_ATTACHMENT0;\r\n        gl.framebufferTexture2D(\r\n            gl.FRAMEBUFFER, attachmentPoint, gl.TEXTURE_2D, targetTexture, level);\r\n        scene.buffers.set(this, {texture: targetTexture, frameBuffer: fb, depthBuffer: depthBuffer});\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n    }\r\n\r\n    /**\r\n     * enable texture in scene.\r\n     * @param scene {RenderScene}\r\n     */\r\n    enable(scene) {\r\n        if (this.lock) return;\r\n        const buffers = scene.buffers.get(this);\r\n        const gl = scene.gl;\r\n        gl.bindTexture(gl.TEXTURE_2D, buffers.texture);\r\n    }\r\n\r\n    bindFrameBuffer(scene){\r\n        const buffers = scene.buffers.get(this);\r\n        const fb = buffers.frameBuffer;\r\n        const gl = scene.gl;\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, fb);\r\n        stack.push(fb);\r\n    }\r\n\r\n    unbindFrameBuffer(scene){\r\n        const gl = scene.gl;\r\n        stack.pop();\r\n        const old = stack.pop();\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, old);\r\n        stack.push(old);\r\n    }\r\n\r\n    /**\r\n     * recursively draw what's seen in the portal.\r\n     */\r\n    update() {\r\n        if (this.lock) return;\r\n        this.lock = true;\r\n        if (!this.cameraMatrix) {\r\n            this.targetScene.draw();\r\n        } else {\r\n            const oldCamera = this.targetScene.cameraMatrix;\r\n            const oldProjection = this.targetScene.projectionMatrix;\r\n            this.targetScene.cameraMatrix = this.cameraMatrix;\r\n            this.targetScene.projectionMatrix = multiply(this.targetScene.perspectiveMatrix, this.cameraMatrix);\r\n            this.targetScene.draw();\r\n            this.targetScene.cameraMatrix = oldCamera;\r\n            this.targetScene.projectionMatrix = oldProjection;\r\n        }\r\n        this.lock = false;\r\n    }\r\n}\r\n\r\nconst stack = [];","import {CameraMappedTexturedShape} from \"./CameraMappedTexturedShape\";\r\nimport {EYE, inverse, multiply} from \"../m4\";\r\nimport {RenderTargetTexture} from \"../Texture/RenderTargetTexture\";\r\n\r\nexport class Portal extends CameraMappedTexturedShape {\r\n\r\n    /**\r\n     *\r\n     * @param s{RenderScene}\r\n     * @param targetTransformationMatrix{Array}\r\n     * @param textureScene {RenderScene||null}\r\n     */\r\n    constructor(s, targetTransformationMatrix, textureScene) {\r\n        const texture = new RenderTargetTexture(textureScene || s);\r\n        super(texture);\r\n        this.textureScene = textureScene || s;\r\n        this.texture = texture;\r\n        targetTransformationMatrix = targetTransformationMatrix || EYE;\r\n        this.vertices = new Float32Array([\r\n            0, 0, 0,\r\n            2, 0, 0,\r\n            0, 2, 0,\r\n            2, 2, 0,\r\n            0, 2, 0,\r\n            2, 0, 0,\r\n        ]);\r\n        this.targetLocation = (targetTransformationMatrix);\r\n        this.forceRender = false;\r\n        this.id = Math.floor(Math.random() * 100000);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param scene {RenderScene}\r\n     */\r\n    init(scene) {\r\n        super.init(scene);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param scene {RenderScene}\r\n     */\r\n    draw(scene) {\r\n        if (this.lock) return;\r\n        renderCallStack.push(this.id);\r\n        const gl = scene.gl;\r\n        this.texture.cameraMatrix = multiply(multiply(scene.cameraMatrix, this.transformationMatrix), inverse(this.targetLocation));\r\n        this.lock = true;\r\n        //test code\r\n        // Check query results here (will be from previous frame or earlier)\r\n        const queryRecord = getQueryRecord(gl);\r\n        let occluded = getQueryStatus(queryRecord, gl);\r\n        if (!occluded || this.forceRender) {\r\n            //console.log(\"portal is being updated: \" + this.id );\r\n            this.texture.bindFrameBuffer(scene);\r\n            enableStencilWrite(gl);\r\n            paintStencil(this, scene);\r\n            useStencilMask(gl);\r\n            this.texture.update();\r\n            cleanUpStencil(gl);\r\n            this.texture.unbindFrameBuffer(scene);\r\n        }\r\n        this.lock = false;\r\n\r\n        if (!queryRecord.queryInProgress) {\r\n            gl.beginQuery(gl.ANY_SAMPLES_PASSED, queryRecord.query);\r\n            super.draw(scene);\r\n            gl.endQuery(gl.ANY_SAMPLES_PASSED);\r\n            queryRecord.queryInProgress = true;\r\n        } else {\r\n            super.draw(scene);\r\n        }\r\n        setBuffer(queryRecord);\r\n        renderCallStack.pop();\r\n    }\r\n\r\n\r\n}\r\n\r\nfunction enableStencilWrite(gl) {\r\n    gl.clear(gl.STENCIL_BUFFER_BIT | gl.DEPTH_BUFFER_BIT | gl.COLOR_BUFFER_BIT);\r\n    gl.enable(gl.STENCIL_TEST);\r\n    gl.stencilOp(gl.KEEP, gl.KEEP, gl.REPLACE);\r\n    gl.stencilFunc(gl.ALWAYS, 1, 0xFF);\r\n    gl.stencilMask(0xFF);\r\n}\r\n\r\nfunction useStencilMask(gl) {\r\n    gl.stencilFunc(gl.EQUAL, 1, 0xFF);\r\n    gl.stencilMask(0x00);\r\n    //gl.clear(gl.DEPTH_BUFFER_BIT|gl.COLOR_BUFFER_BIT);//already done\r\n    //use stack to mark that the parent render process IS using stencil to prevent child from ruining it\r\n    stack.push(true)\r\n}\r\n\r\nfunction cleanUpStencil(gl) {\r\n    gl.clear(gl.STENCIL_BUFFER_BIT);\r\n    stack.pop();\r\n    const flag = stack.pop();\r\n    gl.disable(gl.STENCIL_TEST);\r\n    if (flag) {\r\n        gl.enable(gl.STENCIL_TEST);\r\n    }\r\n    stack.push(flag);\r\n}\r\n\r\n/**\r\n * get status of the query\r\n * @param buffer\r\n * @param gl {WebGL2RenderingContext}\r\n * @returns {boolean}\r\n */\r\nfunction getQueryStatus(buffer, gl) {\r\n    let occluded = true;\r\n    if (buffer.queryInProgress && gl.getQueryParameter(buffer.query, gl.QUERY_RESULT_AVAILABLE)) {\r\n        occluded = !gl.getQueryParameter(buffer.query, gl.QUERY_RESULT);\r\n        buffer.queryInProgress = false;\r\n    }\r\n    return occluded;\r\n}\r\n\r\n/**\r\n * Paint portal to its texture scene stencil according to camera in scene\r\n * @param portal {Portal}\r\n * @param scene {RenderScene}\r\n */\r\nfunction paintStencil(portal, scene) {\r\n    const oldProjectionMatrix = portal.textureScene.projectionMatrix;\r\n    portal.textureScene.projectionMatrix = scene.projectionMatrix;\r\n    portal.textureScene.drawObject(portal);\r\n    portal.textureScene.projectionMatrix = oldProjectionMatrix;\r\n}\r\n\r\n/**\r\n * lookup query record from queries.\r\n * @param gl {WebGL2RenderingContext}\r\n * @returns {{}|*}\r\n */\r\nfunction getQueryRecord(gl) {\r\n    const sum = renderCallStack.reduce((a, b) => 10*a + b, 0);\r\n    if (queries[sum]) {\r\n        return queries[sum];\r\n    }\r\n    const record = {};\r\n    record.query = gl.createQuery();\r\n    record.queryInProgress = false;\r\n    //queries[sum] = record;\r\n    return record;\r\n}\r\n\r\nfunction setBuffer(buffer) {\r\n    const sum = renderCallStack.reduce((a, b) => 10 * a + b, 0);\r\n    queries[sum] = buffer;\r\n}\r\n\r\nconst stack = [];\r\nconst renderCallStack = [];\r\nconst queries = {};","import {EYE, inverse, multiply, transformVector, translate, xRotate, yRotate} from \"../m4\";\r\nimport {AnimationManager} from \"./AnimationManager\";\r\n\r\nexport class PortalWASDMovement extends AnimationManager {\r\n    cameraX = 0;\r\n    cameraY = 1;\r\n    cameraZ = 4;\r\n\r\n    cameraYaw = 0;\r\n    cameraPitch = 0;\r\n\r\n    movementSpeed = 1.9;\r\n    portals = null;\r\n\r\n    update(scene, time) {\r\n        const portals = scene.objects.filter(o => o.targetLocation);\r\n        //here we find all candidates that we may pass\r\n        const candidates = portals.filter(p => {\r\n            const tform = inverse(p.transformationMatrix);\r\n            const newPoint = transformVector(tform, [this.cameraX, this.cameraY, this.cameraZ, 1]);\r\n            return nearPortal(newPoint) && newPoint[2] >= 0;\r\n        })\r\n\r\n        if (!this.oldTime) this.oldTime = 0;\r\n        const timediff = time - this.oldTime;\r\n        this.oldTime = time;\r\n\r\n        scene.objects.map(obj=>obj.update&&obj.update(time,timediff));\r\n\r\n        const [mouseX, mouseY] = scene.input.readMouseMove();\r\n        const keymap = scene.input.readKeymap();\r\n        let zmove = 0, xmove = 0;\r\n        if (keymap.w) {\r\n            zmove -= timediff / 1000 * this.movementSpeed;\r\n        }\r\n        if (keymap.s) {\r\n            zmove += timediff / 1000 * this.movementSpeed;\r\n        }\r\n        if (keymap.a) {\r\n            xmove -= timediff / 1000 * this.movementSpeed;\r\n        }\r\n        if (keymap.d) {\r\n            xmove += timediff / 1000 * this.movementSpeed;\r\n        }\r\n\r\n        const makeRadius = r => {\r\n            if (r < -Math.PI) return r + 2 * Math.PI;\r\n            if (r > Math.PI) return r - 2 * Math.PI;\r\n            return r;\r\n        }\r\n        this.cameraYaw = makeRadius(this.cameraYaw - mouseX / 1200);\r\n        this.cameraPitch = makeRadius(this.cameraPitch - mouseY / 1200);\r\n        this.cameraPitch = this.cameraPitch > Math.PI / 2.2 ? Math.PI / 2.2 : this.cameraPitch;\r\n        this.cameraPitch = this.cameraPitch < -Math.PI / 2.2 ? -Math.PI / 2.2 : this.cameraPitch;\r\n        const resultMove = transformVector(xRotate(yRotate(EYE, this.cameraYaw), this.cameraPitch),\r\n            [xmove, 0, zmove, 1]);\r\n        this.cameraX += resultMove[0];\r\n        this.cameraY += resultMove[1];\r\n        this.cameraZ += resultMove[2];\r\n        //console.log(this.cameraX,this.cameraZ);\r\n        for (let i = 0; i < candidates.length; i++) {\r\n            const c = candidates[i];\r\n            const tform = inverse(c.transformationMatrix);\r\n            const newPoint = transformVector(tform, [this.cameraX, this.cameraY, this.cameraZ, 1]);\r\n\r\n            if (nearPortal(newPoint) && newPoint[2] < 0) {\r\n                [this.cameraX, this.cameraY, this.cameraZ] = transformVector(multiply(c.targetLocation, tform), [this.cameraX, this.cameraY, this.cameraZ, 1]);\r\n                // eslint-disable-next-line no-unused-vars\r\n                const [x, _, z] = transformVector(multiply(c.targetLocation, tform), [0, 0, 1, 0]);\r\n                this.cameraYaw += Math.atan2(x, z);\r\n                //todo pitch support not ready\r\n                break;\r\n            }\r\n        }\r\n\r\n        scene.cameraMatrix = inverse(\r\n            multiply(\r\n                translate(EYE, this.cameraX, this.cameraY, this.cameraZ),\r\n                xRotate(yRotate(EYE, this.cameraYaw), this.cameraPitch)));\r\n        return false;\r\n    }\r\n}\r\n\r\n/**\r\n *\r\n * @param p{Number[]}\r\n */\r\nfunction nearPortal(p) {\r\n    return p[0] >= 0 && p[0] <= 2 && p[1] >= 0 && p[1] <= 2 && p[2] <= 0.2;\r\n}","export class AnimationManager {\r\n\r\n    constructor() {\r\n        this.update = this.update.bind(this);\r\n        this.init = this.init.bind(this);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param scene{RenderScene}\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    init(scene) {\r\n\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param scene{RenderScene}\r\n     * @param time {number}\r\n     * @return {boolean} true if we want to stop the animation.\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    update(scene, time) {\r\n        return false;\r\n    }\r\n}\r\n","/* eslint-disable no-unused-vars */\r\nimport {EYE, multiply, scale3D, translate, yRotate,} from './m4';\r\nimport {RenderScene} from \"./RenderScene\";\r\nimport {ObjFileShape} from \"./Shapes/ObjFileShape\";\r\nimport {URLTexture} from \"./Texture/URLTexture\";\r\nimport {Portal} from \"./Shapes/Portal\";\r\nimport {PortalWASDMovement} from \"./MovementMangers/PortalWASDMovement\";\r\n\r\nasync function main() {\r\n    const canvas = document.querySelector('#canvas');\r\n    const gl = canvas.getContext('webgl2', {stencil: true});\r\n\r\n    const s = new RenderScene(gl);\r\n    const s1 = new RenderScene(gl, s);\r\n    const s2 = new RenderScene(gl, s);\r\n\r\n\r\n    const mm = new PortalWASDMovement();\r\n    s.registerAnimationManager(mm);\r\n\r\n    const island3 = await loadObj(\"island3.obj\", \"island3Color.png\", 2);\r\n    s.addObject(island3);\r\n    s1.addObject(island3);\r\n    island3.translate(10, -3, 3);\r\n\r\n    const island2 = await loadObj(\"island2.obj\", \"island2Color.png\", 2.5);\r\n    s.addObject(island2);\r\n    island2.translate(0, 0, 0);\r\n\r\n    const inside = await loadObj(\"insideIsland2.obj\", \"island2Color.png\", 2.5);\r\n    s1.addObject(inside);\r\n    inside.translate(0, 0, 0);\r\n\r\n    const island1 = await loadObj(\"island1\", \"island1Color.png\", 2);\r\n    island1.translate(-5, 3, -3);\r\n    s.addObject(island1);\r\n    s1.addObject(island1);\r\n\r\n    const room1 = await loadObj(\"rooms.obj\", \"roomColor.png\", .5);\r\n    s.addObject(room1);\r\n    s1.addObject(room1);\r\n    const star1 = await loadObj(\"star1.obj\", \"star1.png\", .5);\r\n    s.addObject(star1);\r\n    s1.addObject(star1);\r\n    star1.translate(0, 50, 0);\r\n    room1.translate(0, 50, 0);\r\n\r\n    const room2 = await loadObj(\"rooms.obj\", \"roomColor.png\", .5);\r\n    s.addObject(room2);\r\n    s2.addObject(room2);\r\n    const star2 = await loadObj(\"star2.obj\", \"star2.png\", .5);\r\n    s.addObject(star2);\r\n    s2.addObject(star2);\r\n    star2.translate(0, -50, 0);\r\n    room2.translate(0, -50, 0);\r\n\r\n    s.drawLoop();//this will start the render loop!\r\n    const scale = .83;\r\n    const scale1 = 1.47;\r\n    const scale2 = .2;\r\n    addPortalPair(s, scale3D(translate(EYE, .398, -.01, 4.62), -.25, .3, -.25), s, scale3D(translate(EYE, -4.95, 3, -3), .25 * scale, .3 * scale, .25 * scale), s, s);\r\n    addPortalPair(s1, scale3D(translate(EYE, .398, -.01, 4.62), -.25, .3, -.25), s1, scale3D(translate(EYE, -4.95, 3, -3), .25 * scale, .3 * scale, .25 * scale), s1, s1);\r\n    addPortalPair(s, scale3D(translate(EYE, 0, 0, -.4), .265, .265, .265), s, scale3D(translate(EYE, 0, 0, -4.344), .265, .265, .265), s1, s1);\r\n    addPortalPair(s, scale3D(translate(EYE, .398, -0.02, -5.22), -.25, .25, -.25), s, scale3D(translate(EYE, 10.055, -3.02, 3.03), .25 * scale1, .25 * scale1, .25 * scale1), s, s1);\r\n\r\n    addPortalPair(s, scale3D(translate(EYE, 9.25, -3, -3.035), scale2, scale2 * .7, scale2), s, scale3D(translate(EYE, -1, 50, 1), .5, .5 * .7, .5), s1, s1);\r\n\r\n    addPortalPair(s,\r\n        scale3D(translate(EYE, 0, 50, 0), .5, .5, .5),\r\n        s,\r\n        scale3D(translate(EYE, 0, -50, -0.0), .5, .5, .5),\r\n        s2,\r\n        s1);\r\n\r\n\r\n    addPortalPair(s,\r\n        scale3D(translate(EYE, 0, -50, 0.0), .5, .5, .5),\r\n        s,\r\n        scale3D(translate(EYE, 0, 50, 0.0), .5, .5, .5),\r\n        s1,\r\n        s2);\r\n\r\n}\r\n\r\n\r\nfunction addPortalPair(scene1, location1, scene2, location2, texScene1, texScene2) {\r\n    texScene1 = texScene1 || scene1;\r\n    texScene2 = texScene2 || scene2;\r\n    const flipPortal = translate(yRotate(EYE, Math.PI), -2, 0, 0);\r\n    const portal = new Portal(texScene1, location2);\r\n    portal.transformationMatrix = location1;\r\n    const portal2 = new Portal(texScene2, multiply(location1, flipPortal));\r\n    portal2.transformationMatrix = multiply(location2, flipPortal);\r\n    scene1.addObject(portal);\r\n    scene2.addObject(portal2);\r\n    if (texScene1) texScene1.addObject(portal);\r\n    if (texScene2) texScene2.addObject(portal2);\r\n    return [portal, portal2];\r\n}\r\n\r\nasync function loadObj(model, texture, resizeFactor) {\r\n    resizeFactor = resizeFactor || 1;\r\n    const ut1 = new URLTexture(\"textures/\" + texture);//texture\r\n    return fetch('objs/' + model)\r\n        .then(response => response.text()).then(House => {\r\n            const fileShape1 = new ObjFileShape(House, ut1, resizeFactor);\r\n            return fileShape1;\r\n        });\r\n}\r\n\r\nmain();\r\n"],"sourceRoot":""}